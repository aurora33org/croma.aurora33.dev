{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/strykerux/aurora33.dev/redux/lib/config.ts"],"sourcesContent":["export const config = {\n  server: {\n    port: parseInt(process.env.PORT || '3000', 10),\n    nodeEnv: process.env.NODE_ENV || 'development'\n  },\n\n  // Upload limits\n  upload: {\n    maxFileSize: parseInt(process.env.MAX_FILE_SIZE || '10485760', 10), // 10MB\n    maxFiles: parseInt(process.env.MAX_FILES || '20', 10),\n    allowedMimeTypes: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp']\n  },\n\n  // Cleanup configuration\n  cleanup: {\n    interval: parseInt(process.env.CLEANUP_INTERVAL || '15', 10), // minutes\n    fileTTL: parseInt(process.env.FILE_TTL || '3600', 10) // seconds (1 hour)\n  },\n\n  // Listmonk (optional)\n  listmonk: {\n    enabled: process.env.LISTMONK_ENABLED === 'true',\n    url: process.env.LISTMONK_URL || '',\n    apiKey: process.env.LISTMONK_API_KEY || '',\n    listId: process.env.LISTMONK_LIST_ID || ''\n  },\n\n  // Storage\n  storage: {\n    baseDir: '/tmp/jobs'\n  },\n\n  // Supported formats\n  supportedFormats: ['jpeg', 'jpg', 'png', 'webp', 'gif'],\n  outputFormats: ['webp', 'jpeg', 'png']\n};\n"],"names":[],"mappings":";;;;AAAO,MAAM,SAAS;IACpB,QAAQ;QACN,MAAM,SAAS,QAAQ,GAAG,CAAC,IAAI,IAAI,QAAQ;QAC3C,SAAS,mDAAwB;IACnC;IAEA,gBAAgB;IAChB,QAAQ;QACN,aAAa,SAAS,QAAQ,GAAG,CAAC,aAAa,IAAI,YAAY;QAC/D,UAAU,SAAS,QAAQ,GAAG,CAAC,SAAS,IAAI,MAAM;QAClD,kBAAkB;YAAC;YAAc;YAAa;YAAa;SAAa;IAC1E;IAEA,wBAAwB;IACxB,SAAS;QACP,UAAU,SAAS,QAAQ,GAAG,CAAC,gBAAgB,IAAI,MAAM;QACzD,SAAS,SAAS,QAAQ,GAAG,CAAC,QAAQ,IAAI,QAAQ,IAAI,mBAAmB;IAC3E;IAEA,sBAAsB;IACtB,UAAU;QACR,SAAS,QAAQ,GAAG,CAAC,gBAAgB,KAAK;QAC1C,KAAK,QAAQ,GAAG,CAAC,YAAY,IAAI;QACjC,QAAQ,QAAQ,GAAG,CAAC,gBAAgB,IAAI;QACxC,QAAQ,QAAQ,GAAG,CAAC,gBAAgB,IAAI;IAC1C;IAEA,UAAU;IACV,SAAS;QACP,SAAS;IACX;IAEA,oBAAoB;IACpB,kBAAkB;QAAC;QAAQ;QAAO;QAAO;QAAQ;KAAM;IACvD,eAAe;QAAC;QAAQ;QAAQ;KAAM;AACxC"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///home/strykerux/aurora33.dev/redux/lib/utils/logger.ts"],"sourcesContent":["import { config } from '../config';\n\nconst colors = {\n  reset: '\\x1b[0m',\n  bright: '\\x1b[1m',\n  red: '\\x1b[31m',\n  green: '\\x1b[32m',\n  yellow: '\\x1b[33m',\n  blue: '\\x1b[34m',\n  magenta: '\\x1b[35m',\n  cyan: '\\x1b[36m'\n};\n\nconst getTimestamp = () => {\n  return new Date().toISOString();\n};\n\nexport const logger = {\n  info: (message: string, ...args: any[]) => {\n    console.log(\n      `${colors.cyan}[INFO]${colors.reset} ${colors.bright}${getTimestamp()}${colors.reset} - ${message}`,\n      ...args\n    );\n  },\n\n  success: (message: string, ...args: any[]) => {\n    console.log(\n      `${colors.green}[SUCCESS]${colors.reset} ${colors.bright}${getTimestamp()}${colors.reset} - ${message}`,\n      ...args\n    );\n  },\n\n  warn: (message: string, ...args: any[]) => {\n    console.warn(\n      `${colors.yellow}[WARN]${colors.reset} ${colors.bright}${getTimestamp()}${colors.reset} - ${message}`,\n      ...args\n    );\n  },\n\n  error: (message: string, ...args: any[]) => {\n    console.error(\n      `${colors.red}[ERROR]${colors.reset} ${colors.bright}${getTimestamp()}${colors.reset} - ${message}`,\n      ...args\n    );\n  },\n\n  debug: (message: string, ...args: any[]) => {\n    if (config.server.nodeEnv === 'development') {\n      console.log(\n        `${colors.magenta}[DEBUG]${colors.reset} ${colors.bright}${getTimestamp()}${colors.reset} - ${message}`,\n        ...args\n      );\n    }\n  }\n};\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,SAAS;IACb,OAAO;IACP,QAAQ;IACR,KAAK;IACL,OAAO;IACP,QAAQ;IACR,MAAM;IACN,SAAS;IACT,MAAM;AACR;AAEA,MAAM,eAAe;IACnB,OAAO,IAAI,OAAO,WAAW;AAC/B;AAEO,MAAM,SAAS;IACpB,MAAM,CAAC,SAAiB,GAAG;QACzB,QAAQ,GAAG,CACT,GAAG,OAAO,IAAI,CAAC,MAAM,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM,GAAG,iBAAiB,OAAO,KAAK,CAAC,GAAG,EAAE,SAAS,KAChG;IAEP;IAEA,SAAS,CAAC,SAAiB,GAAG;QAC5B,QAAQ,GAAG,CACT,GAAG,OAAO,KAAK,CAAC,SAAS,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM,GAAG,iBAAiB,OAAO,KAAK,CAAC,GAAG,EAAE,SAAS,KACpG;IAEP;IAEA,MAAM,CAAC,SAAiB,GAAG;QACzB,QAAQ,IAAI,CACV,GAAG,OAAO,MAAM,CAAC,MAAM,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM,GAAG,iBAAiB,OAAO,KAAK,CAAC,GAAG,EAAE,SAAS,KAClG;IAEP;IAEA,OAAO,CAAC,SAAiB,GAAG;QAC1B,QAAQ,KAAK,CACX,GAAG,OAAO,GAAG,CAAC,OAAO,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM,GAAG,iBAAiB,OAAO,KAAK,CAAC,GAAG,EAAE,SAAS,KAChG;IAEP;IAEA,OAAO,CAAC,SAAiB,GAAG;QAC1B,IAAI,yHAAM,CAAC,MAAM,CAAC,OAAO,KAAK,eAAe;YAC3C,QAAQ,GAAG,CACT,GAAG,OAAO,OAAO,CAAC,OAAO,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM,GAAG,iBAAiB,OAAO,KAAK,CAAC,GAAG,EAAE,SAAS,KACpG;QAEP;IACF;AACF"}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///home/strykerux/aurora33.dev/redux/lib/services/job-manager.ts"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\nimport { logger } from '../utils/logger';\n\ninterface JobFile {\n  filename: string;\n  size: number;\n}\n\ninterface ProcessedFile {\n  filename: string;\n  originalSize: number;\n  compressedSize: number;\n  reduction: number;\n}\n\ninterface Job {\n  id: string;\n  status: 'created' | 'uploading' | 'uploaded' | 'processing' | 'completed' | 'failed';\n  uploadedFiles: JobFile[];\n  processedFiles: ProcessedFile[];\n  settings: any;\n  progress: number;\n  totalFiles: number;\n  processedCount: number;\n  originalSize: number;\n  compressedSize: number;\n  error: string | null;\n  createdAt: number;\n  updatedAt: number;\n}\n\nclass JobManager {\n  private jobs: Map<string, Job> = new Map();\n\n  createJob(): Job {\n    const jobId = uuidv4();\n    const job: Job = {\n      id: jobId,\n      status: 'created',\n      uploadedFiles: [],\n      processedFiles: [],\n      settings: null,\n      progress: 0,\n      totalFiles: 0,\n      processedCount: 0,\n      originalSize: 0,\n      compressedSize: 0,\n      error: null,\n      createdAt: Date.now(),\n      updatedAt: Date.now()\n    };\n\n    this.jobs.set(jobId, job);\n    logger.info(`Created new job: ${jobId}`);\n    return job;\n  }\n\n  getJob(jobId: string): Job | undefined {\n    return this.jobs.get(jobId);\n  }\n\n  updateJob(jobId: string, updates: Partial<Job>): Job | null {\n    const job = this.jobs.get(jobId);\n    if (!job) {\n      logger.warn(`Attempted to update non-existent job: ${jobId}`);\n      return null;\n    }\n\n    Object.assign(job, updates, { updatedAt: Date.now() });\n    this.jobs.set(jobId, job);\n    logger.debug(`Updated job ${jobId}:`, updates);\n    return job;\n  }\n\n  updateProgress(jobId: string, processedCount: number, totalFiles: number): Job | null {\n    const progress = Math.round((processedCount / totalFiles) * 100);\n    return this.updateJob(jobId, {\n      processedCount,\n      progress,\n      status: progress === 100 ? 'completed' : 'processing'\n    });\n  }\n\n  addUploadedFile(jobId: string, filename: string, size: number): Job | null {\n    const job = this.jobs.get(jobId);\n    if (!job) return null;\n\n    job.uploadedFiles.push({ filename, size });\n    job.totalFiles = job.uploadedFiles.length;\n    job.originalSize += size;\n    job.updatedAt = Date.now();\n\n    this.jobs.set(jobId, job);\n    return job;\n  }\n\n  addProcessedFile(jobId: string, filename: string, originalSize: number, compressedSize: number): Job | null {\n    const job = this.jobs.get(jobId);\n    if (!job) return null;\n\n    job.processedFiles.push({\n      filename,\n      originalSize,\n      compressedSize,\n      reduction: Math.round(((originalSize - compressedSize) / originalSize) * 100)\n    });\n    job.compressedSize += compressedSize;\n    job.updatedAt = Date.now();\n\n    this.jobs.set(jobId, job);\n    return job;\n  }\n\n  setJobSettings(jobId: string, settings: any): Job | null {\n    return this.updateJob(jobId, { settings });\n  }\n\n  setJobStatus(jobId: string, status: Job['status'], error: string | null = null): Job | null {\n    return this.updateJob(jobId, { status, error });\n  }\n\n  deleteJob(jobId: string): boolean {\n    const deleted = this.jobs.delete(jobId);\n    if (deleted) {\n      logger.info(`Deleted job from memory: ${jobId}`);\n    }\n    return deleted;\n  }\n\n  getAllJobs(): Job[] {\n    return Array.from(this.jobs.values());\n  }\n\n  getJobStats(jobId: string) {\n    const job = this.jobs.get(jobId);\n    if (!job) return null;\n\n    return {\n      id: job.id,\n      status: job.status,\n      progress: job.progress,\n      totalFiles: job.totalFiles,\n      processedCount: job.processedCount,\n      originalSize: job.originalSize,\n      compressedSize: job.compressedSize,\n      reduction: job.originalSize > 0\n        ? Math.round(((job.originalSize - job.compressedSize) / job.originalSize) * 100)\n        : 0,\n      createdAt: job.createdAt,\n      error: job.error\n    };\n  }\n}\n\n// Global singleton to persist across hot reloads in development\ndeclare global {\n  var jobManagerInstance: JobManager | undefined;\n}\n\nexport const jobManager = global.jobManagerInstance || new JobManager();\n\n// Store reference globally to prevent recreation on hot reload\nif (process.env.NODE_ENV === 'development') {\n  global.jobManagerInstance = jobManager;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 289, "column": 0}, "map": {"version":3,"sources":["file:///home/strykerux/aurora33.dev/redux/lib/services/storage-service.ts"],"sourcesContent":["import { promises as fs } from 'fs';\nimport path from 'path';\nimport { config } from '../config';\nimport { logger } from '../utils/logger';\n\nclass StorageService {\n  private baseDir: string = config.storage.baseDir;\n\n  async initialize() {\n    try {\n      await fs.mkdir(this.baseDir, { recursive: true });\n      logger.info(`Storage initialized at ${this.baseDir}`);\n    } catch (error: any) {\n      logger.error('Failed to initialize storage:', error);\n      throw error;\n    }\n  }\n\n  getJobDir(jobId: string): string {\n    return path.join(this.baseDir, jobId);\n  }\n\n  getUploadDir(jobId: string): string {\n    return path.join(this.getJobDir(jobId), 'uploads');\n  }\n\n  getProcessedDir(jobId: string): string {\n    return path.join(this.getJobDir(jobId), 'processed');\n  }\n\n  async createJobDirectories(jobId: string) {\n    try {\n      const uploadDir = this.getUploadDir(jobId);\n      const processedDir = this.getProcessedDir(jobId);\n\n      await fs.mkdir(uploadDir, { recursive: true });\n      await fs.mkdir(processedDir, { recursive: true });\n\n      logger.debug(`Created directories for job ${jobId}`);\n      return { uploadDir, processedDir };\n    } catch (error: any) {\n      logger.error(`Failed to create directories for job ${jobId}:`, error);\n      throw error;\n    }\n  }\n\n  async saveMetadata(jobId: string, metadata: any) {\n    try {\n      const metadataPath = path.join(this.getJobDir(jobId), 'metadata.json');\n      await fs.writeFile(metadataPath, JSON.stringify(metadata, null, 2));\n      logger.debug(`Saved metadata for job ${jobId}`);\n    } catch (error: any) {\n      logger.error(`Failed to save metadata for job ${jobId}:`, error);\n      throw error;\n    }\n  }\n\n  async getMetadata(jobId: string) {\n    try {\n      const metadataPath = path.join(this.getJobDir(jobId), 'metadata.json');\n      const data = await fs.readFile(metadataPath, 'utf-8');\n      return JSON.parse(data);\n    } catch (error: any) {\n      logger.error(`Failed to read metadata for job ${jobId}:`, error);\n      return null;\n    }\n  }\n\n  async listFiles(directory: string): Promise<string[]> {\n    try {\n      const files = await fs.readdir(directory);\n      return files.filter(file => !file.startsWith('.'));\n    } catch (error: any) {\n      logger.error(`Failed to list files in ${directory}:`, error);\n      return [];\n    }\n  }\n\n  async getFileStats(filePath: string) {\n    try {\n      const stats = await fs.stat(filePath);\n      return {\n        size: stats.size,\n        created: stats.birthtime,\n        modified: stats.mtime\n      };\n    } catch (error: any) {\n      logger.error(`Failed to get stats for ${filePath}:`, error);\n      return null;\n    }\n  }\n\n  async deleteJob(jobId: string): Promise<boolean> {\n    try {\n      const jobDir = this.getJobDir(jobId);\n      await fs.rm(jobDir, { recursive: true, force: true });\n      logger.info(`Deleted job directory: ${jobId}`);\n      return true;\n    } catch (error: any) {\n      logger.error(`Failed to delete job ${jobId}:`, error);\n      return false;\n    }\n  }\n\n  async cleanupOldJobs(maxAge: number): Promise<number> {\n    try {\n      const jobs = await fs.readdir(this.baseDir);\n      const now = Date.now();\n      let cleaned = 0;\n\n      for (const jobId of jobs) {\n        const jobDir = this.getJobDir(jobId);\n        const metadataPath = path.join(jobDir, 'metadata.json');\n\n        try {\n          const stats = await fs.stat(metadataPath);\n          const age = (now - stats.mtime.getTime()) / 1000; // seconds\n\n          if (age > maxAge) {\n            await this.deleteJob(jobId);\n            cleaned++;\n          }\n        } catch (error) {\n          // If metadata doesn't exist, delete the job anyway\n          await this.deleteJob(jobId);\n          cleaned++;\n        }\n      }\n\n      if (cleaned > 0) {\n        logger.info(`Cleanup completed: removed ${cleaned} old job(s)`);\n      }\n\n      return cleaned;\n    } catch (error: any) {\n      logger.error('Failed to cleanup old jobs:', error);\n      return 0;\n    }\n  }\n}\n\n// Global singleton to persist across hot reloads in development\ndeclare global {\n  var storageServiceInstance: StorageService | undefined;\n}\n\nexport const storageService = global.storageServiceInstance || new StorageService();\n\n// Store reference globally to prevent recreation on hot reload\nif (process.env.NODE_ENV === 'development') {\n  global.storageServiceInstance = storageService;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 451, "column": 0}, "map": {"version":3,"sources":["file:///home/strykerux/aurora33.dev/redux/lib/services/cleanup-service.ts"],"sourcesContent":["import cron, { ScheduledTask } from 'node-cron';\nimport { config } from '../config';\nimport { storageService } from './storage-service';\nimport { jobManager } from './job-manager';\nimport { logger } from '../utils/logger';\n\nclass CleanupService {\n  private task: ScheduledTask | null = null;\n  private isRunning = false;\n\n  start() {\n    if (this.task) {\n      logger.warn('Cleanup service is already running');\n      return;\n    }\n\n    // Run every N minutes based on config\n    const cronExpression = `*/${config.cleanup.interval} * * * *`;\n\n    this.task = cron.schedule(cronExpression, async () => {\n      await this.cleanup();\n    });\n\n    logger.info(`Cleanup service started (runs every ${config.cleanup.interval} minutes)`);\n\n    // Run initial cleanup after 1 minute\n    setTimeout(() => this.cleanup(), 60000);\n  }\n\n  async cleanup() {\n    if (this.isRunning) {\n      logger.debug('Cleanup already in progress, skipping...');\n      return;\n    }\n\n    this.isRunning = true;\n    logger.info('Starting cleanup...');\n\n    try {\n      // Clean up old job files\n      const cleaned = await storageService.cleanupOldJobs(config.cleanup.fileTTL);\n\n      // Clean up old jobs from memory\n      const jobs = jobManager.getAllJobs();\n      const now = Date.now();\n      let memoryCleanedCount = 0;\n\n      for (const job of jobs) {\n        const age = (now - job.updatedAt) / 1000; // seconds\n        if (age > config.cleanup.fileTTL) {\n          jobManager.deleteJob(job.id);\n          memoryCleanedCount++;\n        }\n      }\n\n      if (memoryCleanedCount > 0) {\n        logger.info(`Removed ${memoryCleanedCount} old job(s) from memory`);\n      }\n\n      if (cleaned > 0 || memoryCleanedCount > 0) {\n        logger.success(`Cleanup completed: ${cleaned} file jobs, ${memoryCleanedCount} memory jobs`);\n      } else {\n        logger.debug('Cleanup completed: nothing to clean');\n      }\n    } catch (error) {\n      logger.error('Cleanup failed:', error);\n    } finally {\n      this.isRunning = false;\n    }\n  }\n\n  stop() {\n    if (this.task) {\n      this.task.stop();\n      this.task = null;\n      logger.info('Cleanup service stopped');\n    }\n  }\n\n  async runNow() {\n    return this.cleanup();\n  }\n}\n\n// Global singleton to persist across hot reloads in development\ndeclare global {\n  var cleanupServiceInstance: CleanupService | undefined;\n}\n\nexport const cleanupService = global.cleanupServiceInstance || new CleanupService();\n\n// Store reference globally to prevent recreation on hot reload\nif (process.env.NODE_ENV === 'development') {\n  global.cleanupServiceInstance = cleanupService;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;AAEA,MAAM;IACI,OAA6B,KAAK;IAClC,YAAY,MAAM;IAE1B,QAAQ;QACN,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,kIAAM,CAAC,IAAI,CAAC;YACZ;QACF;QAEA,sCAAsC;QACtC,MAAM,iBAAiB,CAAC,EAAE,EAAE,yHAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC;QAE7D,IAAI,CAAC,IAAI,GAAG,mIAAI,CAAC,QAAQ,CAAC,gBAAgB;YACxC,MAAM,IAAI,CAAC,OAAO;QACpB;QAEA,kIAAM,CAAC,IAAI,CAAC,CAAC,oCAAoC,EAAE,yHAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC;QAErF,qCAAqC;QACrC,WAAW,IAAM,IAAI,CAAC,OAAO,IAAI;IACnC;IAEA,MAAM,UAAU;QACd,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,kIAAM,CAAC,KAAK,CAAC;YACb;QACF;QAEA,IAAI,CAAC,SAAS,GAAG;QACjB,kIAAM,CAAC,IAAI,CAAC;QAEZ,IAAI;YACF,yBAAyB;YACzB,MAAM,UAAU,MAAM,yJAAc,CAAC,cAAc,CAAC,yHAAM,CAAC,OAAO,CAAC,OAAO;YAE1E,gCAAgC;YAChC,MAAM,OAAO,iJAAU,CAAC,UAAU;YAClC,MAAM,MAAM,KAAK,GAAG;YACpB,IAAI,qBAAqB;YAEzB,KAAK,MAAM,OAAO,KAAM;gBACtB,MAAM,MAAM,CAAC,MAAM,IAAI,SAAS,IAAI,MAAM,UAAU;gBACpD,IAAI,MAAM,yHAAM,CAAC,OAAO,CAAC,OAAO,EAAE;oBAChC,iJAAU,CAAC,SAAS,CAAC,IAAI,EAAE;oBAC3B;gBACF;YACF;YAEA,IAAI,qBAAqB,GAAG;gBAC1B,kIAAM,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,mBAAmB,uBAAuB,CAAC;YACpE;YAEA,IAAI,UAAU,KAAK,qBAAqB,GAAG;gBACzC,kIAAM,CAAC,OAAO,CAAC,CAAC,mBAAmB,EAAE,QAAQ,YAAY,EAAE,mBAAmB,YAAY,CAAC;YAC7F,OAAO;gBACL,kIAAM,CAAC,KAAK,CAAC;YACf;QACF,EAAE,OAAO,OAAO;YACd,kIAAM,CAAC,KAAK,CAAC,mBAAmB;QAClC,SAAU;YACR,IAAI,CAAC,SAAS,GAAG;QACnB;IACF;IAEA,OAAO;QACL,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI,CAAC,IAAI,CAAC,IAAI;YACd,IAAI,CAAC,IAAI,GAAG;YACZ,kIAAM,CAAC,IAAI,CAAC;QACd;IACF;IAEA,MAAM,SAAS;QACb,OAAO,IAAI,CAAC,OAAO;IACrB;AACF;AAOO,MAAM,iBAAiB,OAAO,sBAAsB,IAAI,IAAI;AAEnE,+DAA+D;AAC/D,wCAA4C;IAC1C,OAAO,sBAAsB,GAAG;AAClC"}},
    {"offset": {"line": 544, "column": 0}, "map": {"version":3,"sources":["file:///home/strykerux/aurora33.dev/redux/lib/services/index.ts"],"sourcesContent":["/**\n * Centralized service initialization to ensure singleton pattern in Next.js\n */\nimport { jobManager } from './job-manager';\nimport { storageService } from './storage-service';\nimport { cleanupService } from './cleanup-service';\n\n// Initialize services on first import\nasync function initializeServices() {\n  try {\n    await storageService.initialize();\n    cleanupService.start();\n  } catch (error) {\n    console.error('Failed to initialize services:', error);\n  }\n}\n\n// Run initialization\ninitializeServices().catch(console.error);\n\nexport { jobManager, storageService, cleanupService };\n"],"names":[],"mappings":"AAAA;;CAEC;AACD;AACA;AACA;;;;;;;;AAEA,sCAAsC;AACtC,eAAe;IACb,IAAI;QACF,MAAM,yJAAc,CAAC,UAAU;QAC/B,yJAAc,CAAC,KAAK;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;IAClD;AACF;AAEA,qBAAqB;AACrB,qBAAqB,KAAK,CAAC,QAAQ,KAAK"}},
    {"offset": {"line": 576, "column": 0}, "map": {"version":3,"sources":["file:///home/strykerux/aurora33.dev/redux/app/api/jobs/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { jobManager, storageService } from '@/lib/services';\nimport { logger } from '@/lib/utils/logger';\n\n/**\n * POST /api/jobs\n * Create a new compression job\n */\nexport async function POST() {\n  try {\n    const job = jobManager.createJob();\n    await storageService.createJobDirectories(job.id);\n\n    logger.success(`Created job: ${job.id}`);\n\n    return NextResponse.json({\n      success: true,\n      jobId: job.id,\n      message: 'Job created successfully'\n    }, { status: 201 });\n  } catch (error: any) {\n    logger.error('Failed to create job:', error.message);\n    return NextResponse.json(\n      { success: false, error: error.message },\n      { status: 500 }\n    );\n  }\n}\n\n/**\n * GET /api/jobs\n * Get all jobs (debugging/monitoring only)\n */\nexport async function GET() {\n  try {\n    const jobs = jobManager.getAllJobs();\n    return NextResponse.json({\n      success: true,\n      jobs\n    });\n  } catch (error: any) {\n    return NextResponse.json(\n      { success: false, error: error.message },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AAAA;AACA;;;;;;;;AAMO,eAAe;IACpB,IAAI;QACF,MAAM,MAAM,iJAAU,CAAC,SAAS;QAChC,MAAM,yJAAc,CAAC,oBAAoB,CAAC,IAAI,EAAE;QAEhD,kIAAM,CAAC,OAAO,CAAC,CAAC,aAAa,EAAE,IAAI,EAAE,EAAE;QAEvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,IAAI,EAAE;YACb,SAAS;QACX,GAAG;YAAE,QAAQ;QAAI;IACnB,EAAE,OAAO,OAAY;QACnB,kIAAM,CAAC,KAAK,CAAC,yBAAyB,MAAM,OAAO;QACnD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF;AAMO,eAAe;IACpB,IAAI;QACF,MAAM,OAAO,iJAAU,CAAC,UAAU;QAClC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;QACF;IACF,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}